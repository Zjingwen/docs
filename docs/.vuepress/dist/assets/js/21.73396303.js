(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{323:function(t,s,a){"use strict";a.r(s);var n=a(38),e=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"_006-不浅谈，就是让你看一看，数十条业务线以上的，前端小团队瞎逼基础服务思路"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_006-不浅谈，就是让你看一看，数十条业务线以上的，前端小团队瞎逼基础服务思路","aria-hidden":"true"}},[t._v("#")]),t._v(" 006.不浅谈，就是让你看一看，数十条业务线以上的，前端小团队瞎逼基础服务思路")]),t._v(" "),a("p",[t._v("！！！高能预警，长文，我都不知道多少字。")]),t._v(" "),a("p",[t._v("背景")]),t._v(" "),a("p",[t._v("我嘛，虽然不是出身bat，写了三年多业务代码，18年开始带团队至今，从toB的pc、管理台、小程序、微信公众号、app、活动、服务端，都有涉猎。当然公司小，我这种人就是跟着公司一点一点成长起来的，没有前人栽树，只能自己动手，天资不够，只能靠肝。大概在17年底的时候，带我的老大（老大呀，看到文章别diss我）离职了，我就这样被赶鸭子上架（其实我的心态是崩溃的，没玩过呀）做了起了前端负责人，后来经历老员工离职，招聘，新员工入职，公司明确业务，业务量爆发，前端业务线暴涨之后，有幸做一些简单的基础服务，这套东西能让3个前端，应付10条以上业务线，我可以自豪的说1年多以来，单季度，bug数<=1、技术问题延期<=0。经历了百来个活动页，3个移动端，8个管理台，1个pc商城，2个小程序，上千万的pv，各种瞎逼情况慢慢磨练出来的。历时至今，1年半的时间，我算是做出了一些，我想做的事情。")]),t._v(" "),a("p",[t._v("目前全公司涉及前端业务线")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("mobile 3条")]),t._v(" "),a("ul",[a("li",[t._v("商城性质")]),t._v(" "),a("li",[t._v("管理性质")]),t._v(" "),a("li",[t._v("活动性质")])])]),t._v(" "),a("li",[a("p",[t._v("小程序 2条")]),t._v(" "),a("ul",[a("li",[t._v("商城性质")]),t._v(" "),a("li",[t._v("备用小程序")])])]),t._v(" "),a("li",[a("p",[t._v("pc端  9条")]),t._v(" "),a("ul",[a("li",[t._v("对外商城性质")]),t._v(" "),a("li",[t._v("对外数据管理台")]),t._v(" "),a("li",[t._v("内部运营管理台")]),t._v(" "),a("li",[t._v("内部自营管理台")]),t._v(" "),a("li",[t._v("内部财务管理台")]),t._v(" "),a("li",[t._v("半内半外的招商管理台")]),t._v(" "),a("li",[t._v("对外第三方商家管理台")]),t._v(" "),a("li",[t._v("旧，运营管理台")]),t._v(" "),a("li",[t._v("旧，招商管理台")])])])]),t._v(" "),a("h2",{attrs:{id:"基础服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基础服务","aria-hidden":"true"}},[t._v("#")]),t._v(" 基础服务")]),t._v(" "),a("h3",{attrs:{id:"技术栈选择"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#技术栈选择","aria-hidden":"true"}},[t._v("#")]),t._v(" 技术栈选择")]),t._v(" "),a("ul",[a("li",[t._v("移动端")])]),t._v(" "),a("p",[t._v("技术栈选择Vue全家桶，从我的视角来说，移动端的交互不会特别复杂，最多sku选择、地址、动画，而且这一块大部分都是纯面向用户的需求，很难做业务收束，而且很难解耦。基于我的思考，我就想到vue了，轻便、简单、插件丰富，vue满足我的所有需求。说简单点，我一个业务new个Vue对象，写一堆配置/方法就搞定了。活动的话，我选择了nuxt，活动这种轻便的东西，我静态化就好了。")]),t._v(" "),a("ul",[a("li",[t._v("pc端")])]),t._v(" "),a("p",[t._v("技术栈选择React全家桶，从我的视角来说，pc端我面向的都是管理台需求居多，涉及的交互可能会相对而言复杂，会有拖拽、富文本、页面编辑、图表等等交互出现，这个时候React这种以Component为基本单位的库对于这类业务来说，就很舒服了，解耦不要太爽。")]),t._v(" "),a("ul",[a("li",[t._v("小程序用原生")])]),t._v(" "),a("p",[t._v("我这边就只有微信小程序，原生确实够用了，而且原生小程序框架也越来越强大，等需要扩展渠道时，我再选择Taro、mpVue等东西。")]),t._v(" "),a("ul",[a("li",[t._v("npm")])]),t._v(" "),a("p",[t._v("请搭建私有的npm，可以做到公共方法的收集，集中化处理。")]),t._v(" "),a("ul",[a("li",[t._v("mock平台")])]),t._v(" "),a("p",[t._v("搭建0业务入侵的mock平台。")]),t._v(" "),a("ul",[a("li",[t._v("nginx管理")])]),t._v(" "),a("p",[t._v("集中管理前端的nginx。")]),t._v(" "),a("ul",[a("li",[t._v("git仓库")])]),t._v(" "),a("p",[t._v("gitlab天下第一。")]),t._v(" "),a("ul",[a("li",[t._v("项目模版")])]),t._v(" "),a("p",[t._v("将vue、react根据业务，制作为基础模版，以后展开新业务直接copy即可。")]),t._v(" "),a("ul",[a("li",[t._v("持续发布")])]),t._v(" "),a("p",[t._v("jekins天下第一")]),t._v(" "),a("ul",[a("li",[t._v("eslint")])]),t._v(" "),a("p",[t._v("服务器初始化")]),t._v(" "),a("ul",[a("li",[t._v("脚本")])]),t._v(" "),a("p",[t._v("总结：其实最有争议的应该是技术栈的选择了，为啥要既有vue、又有react、还有小程序、nuxt，不好意思，我觉得在不同场景下，使用不同的库是合理的。并且作为一个程序员，你的学习能力跟不上，那你还是自己走吧。我还没上typeScript、Rx.js呢。还有就是招聘问题，不好意思，当面试者问我公司前端技术栈时，大部分都跃跃欲试。成本吧，反正不贵。")]),t._v(" "),a("h2",{attrs:{id:"具体实现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#具体实现","aria-hidden":"true"}},[t._v("#")]),t._v(" 具体实现")]),t._v(" "),a("p",[t._v("这里我只对，nginx管理、私有的npm、mock平台、项目模版、服务器初始化，做详细具体解释。其余的提一点，就不做解释了，因为jekins就是配置，这个业务性太强，eslint没啥讲的，git仓库也没啥讲的，小程序原生、pc端、移动端这都是纯业务的东西，也没啥讲的。")]),t._v(" "),a("h3",{attrs:{id:"nginx管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx管理","aria-hidden":"true"}},[t._v("#")]),t._v(" nginx管理")]),t._v(" "),a("p",[t._v("新建nginxConfig文件夹，目录结构如下。")]),t._v(" "),a("div",{staticClass:"language-txt extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("nginxConfig\n|----- build.sh                                 # 脚本\n|----- server.develop.xxxx.com.conf             # 对外服务的nginx配置\n|----- server.develop.xxxx.com.ssl.conf         # 对外服务的nginx，https配置\n|----- server.test.xxxx.com.conf                # 测试服务器的nginx配置，涵盖所有业务\n|----- server.test.xxxx.com.ssl.conf            # 测试服务器的nginx，https配置，涵盖所有业务\n|----- server.admin.xxxx.com.conf               # 管理台的nginx配置\n|----- server.admin.xxxx.com.conf.ssl.conf      # 管理台的nginx，https配置\n")])])]),a("p",[t._v("请善用脚本，其实我只需要将nginx，发布到服务器上面根据不同服务器，cp不同nginx配置，然后relaod即可。nginx重启失败我倒是没有碰过，我用这套已经部署了n台活动服务器、n台管理台服务器。当然，写nginx时请在测试服务器谨慎测试。我一般是凌晨3、4点去折腾的，谁叫我肝好呢。")]),t._v(" "),a("p",[t._v("附上脚本代码")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /bin/bash")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"请选择你要替换的nginx"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1) 替换xxxx，nginx"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2) 替换xxxx，https的nginx"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3) 替换xxxx，的nginx"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"4) 替换xxxx，https的nginx"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"5) 替换xxxx，的nginx"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"6) 替换xxxx，https的nginx"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("read")]),t._v(" number\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$number")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"替换xxxx，http的nginx"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("cp server.admin.xxxx.com.conf /etc/nginx/conf.d/\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("service")]),t._v(" nginx -reload\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"替换xxxx，https的nginx"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("cp server.admin.xxxx.com.ssl.conf /etc/nginx/conf.d/\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("service")]),t._v(" nginx -reload\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"替换xxxx的nginx"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("cp server.test.xxxx.com.conf /etc/nginx/conf.d/\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("service")]),t._v(" nginx -reload\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"替换xxxx，https的nginx"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("cp server.test.xxxx.com.ssl.conf /etc/nginx/conf.d/\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("service")]),t._v(" nginx -reload\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"替换xxxx的nginx"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("cp server.develop.xxxx.com.conf /etc/nginx/conf.d/\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("service")]),t._v(" nginx -reload\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"替换xxxx，https的nginx"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("cp server.develop.xxxx.com.ssl.conf /etc/nginx/conf.d/\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("service")]),t._v(" nginx -reload\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("esac")]),t._v("\n")])])]),a("p",[t._v("告诉你通过脚本编写好处，别看我现在虽然是手动到服务器上去git pull 然后sh build脚本，我完全可以无缝的切到jekins，因为我是脚本呀，配置执行命令就好了呀。我把输入判断改为常量不就好了么。")]),t._v(" "),a("h3",{attrs:{id:"nginx配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx配置","aria-hidden":"true"}},[t._v("#")]),t._v(" nginx配置")]),t._v(" "),a("p",[t._v("我只做了最简单nginx配置，没有优化，我还没空去细致研究，其实这一层还能做很多。但是我简单的需求就是，通过域名的路径去匹配页面，然后proxy。当然我不是单一项目，而是多项目，这里会涉及正则。")]),t._v(" "),a("p",[t._v("附上例子代码")]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v(" _"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("charset")]),t._v(" utf"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("access_log")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("var"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("www"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("log"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx_access"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("error_log")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("var"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("www"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("log"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx_error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("var"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("www"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("xxxx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("api"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("xxx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("www"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxxxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("api"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("xxx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("www"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxxxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("aaa "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("alias")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("xxxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try_files")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("xxx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("ccc "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("alias")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("xxxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try_files")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("404")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("首先，我这边可能会有"),a("code",[t._v("www.xxx.com/h5")]),t._v("，"),a("code",[t._v("www.xxx.com/admin")]),t._v("的情况，而且我会根据"),a("code",[t._v("/api-xxx")]),t._v("的不同，去请求不同的服务。"),a("code",[t._v("location ^~ /aaa")]),t._v(" 是针对spa的配置，"),a("code",[t._v("location ^~ /ccc")]),t._v("是针对静态化页面的配置。为啥我不用cdn去缓存html页面呢？不好意思业务问题不赘述。上述只是例子代码，你可以看思路，可别直接在线上用，业务不同需求不同。")]),t._v(" "),a("p",[t._v("总结：善用脚本解决问题，减少重复劳动。")]),t._v(" "),a("h3",{attrs:{id:"mock平台"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mock平台","aria-hidden":"true"}},[t._v("#")]),t._v(" mock平台")]),t._v(" "),a("p",[t._v("首先你mock的平台最好做到0业务入侵，只切换变量即可，要配合好注释and文档。我的端口可能面对pc、mobile、小程序等。首先浏览器端，我会针对webpack的开发配置做改动。小程序我会二次封装"),a("code",[t._v("wx.request")]),t._v("。具体实现例子如下。")]),t._v(" "),a("p",[t._v("所有浏览器端")]),t._v(" "),a("div",{staticClass:"language-test extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('// 开发环境 webpack dev server配置\nconst PATH = require(\'../package.json\').conf_liberty[\'path\'];\nconst URL = require(\'../package.json\').conf_liberty[\'url\'];\n\n"/api":{\n  "target": URL[PATH],\n  "pathRewrite": {\n    "^/api-xxx": "/xxx",\n  }\n}\n')])])]),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// package.json")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"conf_liberty"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"path"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mock"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"url"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"mock"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://xxx.xxx.com/mock/xxx/"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// mock 数据请求地址")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"test"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://xxx.test.xxx.com"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 测试机的请求地址")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"pre"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://xxx.xxx.com/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 预发布的请求地址")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"online"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://xxx.xxx.com/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 正式环境的请求地址")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("小程序端")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// config/url.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * 小程序配置文件、切换环境直接切换变量即可\n * @param mock 模拟数据环境\n * @param test 测试环境\n * @param pre 线上测试环境\n * @param online 正式环境\n */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" envir "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'online'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 环境阀门")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" configMap "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mock'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// mock 数据请求地址")]),t._v("\n    url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://xxx.xxx.com/mock/xxx/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 测试机的请求地址")]),t._v("\n    url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://xxx.test.xxx.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'pre'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 预发布的请求地址")]),t._v("\n    url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://xxx.xxx.com/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'online'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 正式环境的请求地址")]),t._v("\n    url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://xxx.xxx.com/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" config "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" configMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("envir"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  baseUrl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 二次封装的wx.request")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 为什么要封装成class，因为我有业务扩展，看个思路即可。")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("baseUrl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../config/url'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("request")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("params")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Promise")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resolve"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" baseUrl "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      wx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("success")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("result")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("fail")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("complete")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("response")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("request")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),a("p",[t._v("每次开发，当开发人员和后端对好接口文档，到mock服务器写好mock，然后就可以在有数据的情况下愉快的开发了，而且的mock的数据更加全面带有随机性质符合前端开发人员需求，需要debug时甚至可以直接切换线上数据，但是操作线上数据需要时刻注意，这必须要引起开发人员重视。当然带有上传性质的接口，不太好测试。但是这点是可以解决的。需要和后端调试，我切换到test即可，多么的简单。我认为前端的很多的bug问题，都是数据的多样性导致开发人员没有考虑到，所带来的结果。")]),t._v(" "),a("p",[t._v("mock平台的选择")]),t._v(" "),a("p",[t._v("首先，我有两个种做法上的选择，线上服务器mock，本地服务器mock，我选择了线上服务器mock做法，因为我mock的数据会越来越多，提交到git上真难看，而且本地写json的形式，对于文档的整理不太友好，并且业务线确实有点多，需要总线式的管理，所有果断放弃。")]),t._v(" "),a("p",[t._v("接下来，我对比的"),a("code",[t._v("easy-mock")]),t._v("，"),a("code",[t._v("yapi")]),t._v("，"),a("code",[t._v("云效平台")]),t._v("，三种mock服务器平台之后，我选择了"),a("code",[t._v("yapi")]),t._v("。先来说说我的标准，内网服务、搭建简单、升级容易、依赖少、不花钱，另外2种不是不好，只是我的选择而已。先说说"),a("code",[t._v("easy-mock")]),t._v("的我的看法，麻烦，依赖了"),a("code",[t._v("Node")]),t._v("、"),a("code",[t._v("MongoDB")]),t._v("、"),a("code",[t._v("Redis")]),t._v("，没有一键安装，一键化升级，甚至我还没找到如何升级，也许我眼拙。云效平台，我就看到了简介，怎么用我都没找到，阿里云的服务嘛，估计还要收费算了。来说说"),a("code",[t._v("yapi")]),t._v("，首先依赖轻，有"),a("code",[t._v("Node")]),t._v("、"),a("code",[t._v("MongoDB")]),t._v("就好了。安装太简单"),a("code",[t._v("npm install -g yapi-cli")]),t._v("，执行一下"),a("code",[t._v("yapi server")]),t._v("，配置一下数据库，点一点就ok了。我就花了1个小时左右就搞定了。后续升级"),a("code",[t._v("yapi update")]),t._v("一下好了。多么的愉快。而且基本满足我的需求，基本的mock、高级的mock、文档导入导出非常完美，甚至能测试线上数据，简单的"),a("code",[t._v("postman")]),t._v("功能也行，连nginx配置官方都帮我想好了。目前我已经在全部业务线使用，而且推荐给客户端、后端同学使用，只能说好评连连。而且以我粗浅的能力，尚能看得懂"),a("code",[t._v("yapi")]),t._v("的机制，就算官方不维护了，我也能打打补丁。想知道如何安装的，去"),a("a",{attrs:{href:"https://yapi.ymfe.org/index.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("yapi"),a("OutboundLink")],1),t._v("官网看就好了。")]),t._v(" "),a("p",[t._v("安装方法")]),t._v(" "),a("p",[t._v("来说说我的安装方法把，首先我会在本地安装"),a("code",[t._v("npm install -g yapi-cli")]),t._v("，做好基本调试，配置好数据库，我用的是远程数据库。写好"),a("code",[t._v("config.json")]),t._v("基本配置，然后push到git上。到指定服务器pull即可，安好pm2，启动。后续升级也是这样，先本地升级测试一下，然后到服务器pull重启，当然这是可以结合jekins。")]),t._v(" "),a("p",[t._v("总结：这种工具服务的选择没有啥对错，只要符合当前业务开发，并且可以基本的持续迭代即可，自主研发也好，第三方服务也罢，怎么都行，一切以加速业务开发为导向。")]),t._v(" "),a("h2",{attrs:{id:"私有的npm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#私有的npm","aria-hidden":"true"}},[t._v("#")]),t._v(" 私有的npm")]),t._v(" "),a("p",[t._v("首先业务线有点多，而且基本可以做到一些方法复用例如：客户端版本判断、UA检测、统计服务、JSbridge等等，组件二次封装等。例如：ant design的图片上传，你每次写一堆配置，其实你需要配置的无非是"),a("code",[t._v("action")]),t._v("，"),a("code",[t._v("disabled")]),t._v("，"),a("code",[t._v("onChange")]),t._v("，"),a("code",[t._v("name")]),t._v("你是不是可以跟后端商量固定"),a("code",[t._v("action")]),t._v("，给一个当前业务的基础接口做成业务组件。再极端一点，我完全可以做成npm包，让后端同学提供一个完全独立的服务。我发现很多前端，对于UI库是真拿来主义，拿来就用，拜托，你有没有发现，其实你每次用UI库里面的东西，写一坨不累么。人家组件是为了适应90%场景的，而你在实际业务中所用到可能不到10%。请你提高一下自己的效率可好？")]),t._v(" "),a("p",[t._v("例如：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 经过二次封装的上传组建")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" upladFileConf "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  title"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'上传'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 按钮内容")]),t._v("\n  disabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 是否禁用")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("callBack")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("e")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("handleUpload")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 成功回调")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("callError")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("handleError")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 失败回调")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("UpladFile "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("upladFileConf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 经过二次封装的弹窗组件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" conf "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  visible"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" visible"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 是否显示")]),t._v("\n  title"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'弹窗标题'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 标题")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onCancel")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("res")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("onCancel")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 确定按钮or取消按钮，回调")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Modal "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("Modal"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("私有npm服务选择")]),t._v(" "),a("p",[t._v("先说我的需求，简单好用，稳定，方便部署，及时通知，在我对比的"),a("code",[t._v("cnpm")]),t._v("、"),a("code",[t._v("sinopia")]),t._v("、"),a("code",[t._v("verdaccio")]),t._v("、"),a("code",[t._v("Nexus")]),t._v("之后。我的结论是"),a("code",[t._v("verdaccio")]),t._v("，"),a("code",[t._v("cnpm")]),t._v("感觉插件有点少貌似，没有钉钉推送的插件，"),a("code",[t._v("sinopia")]),t._v("都凉了不考虑，"),a("code",[t._v("Nexus")]),t._v("吧没必要，我就前端用用而已。"),a("code",[t._v("verdaccio")]),t._v("目前看到还行，继承了"),a("code",[t._v("sinopia")]),t._v("，插件满足我的需求，安装简单，上线小半年没啥问题，目前有十几个私有包，连数据库都不用折腾。路径切换选择用"),a("code",[t._v("nrm")]),t._v("即可。")]),t._v(" "),a("p",[t._v("安装方法")]),t._v(" "),a("p",[t._v("首先我依旧会在本地安装好，"),a("code",[t._v("npm install -g verdaccio")]),t._v("，配置好"),a("code",[t._v("config.yaml")]),t._v("，装好钉钉通知，做好目录屏蔽，然后迁移到我的git中，然后书写shell脚本。")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# build.sh")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /bin/bash")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启动私有npm脚本")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("work_path")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("pwd")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("\nverdaccio --listen "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4873")]),t._v(" --config "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${work_path}")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/verdaccio/config.yaml"')]),t._v("\n")])])]),a("p",[t._v("然后每次我需要调试配置时，我先在本地测试，push一下，到服务器pull一下，执行"),a("code",[t._v("pm2 start build.sh")]),t._v("或者"),a("code",[t._v("pm2 restart build")]),t._v("。当然这也是可以加到jekins。")]),t._v(" "),a("p",[t._v("注意")]),t._v(" "),a("p",[t._v("yaml这种配置文件请认真去研究一下怎么写，缩进空格有点不同。"),a("code",[t._v("storage/.sinopia-db.json")]),t._v("一定要是json格式不能为空，而且内容可以是"),a("code",[t._v('{"list":[],"secret":""}')])]),t._v(" "),a("p",[t._v("总结：其实搭建私有npm不难，难在如何设置私有npm包的发布规则，互相依赖升级等，可以用lerna来做。私有npm规则，以及lerna的使用，等我稍后总结。")]),t._v(" "),a("h2",{attrs:{id:"项目模版"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#项目模版","aria-hidden":"true"}},[t._v("#")]),t._v(" 项目模版")]),t._v(" "),a("p",[t._v("每次new cli我不反对，但是真的不累么，那么多包要加，有些特有的地方架子还要改。目前我总结出3套，ant-admin-template、nuxt-mobile-template、spa-mobile-template。")]),t._v(" "),a("p",[t._v("实现方法（只以admin例子）")]),t._v(" "),a("p",[t._v("新开目录，然后执行new cli，生成基础项目模版。对基础模版做一些调整，并且安装一些基础包")]),t._v(" "),a("p",[t._v("调整的基础模版")]),t._v(" "),a("div",{staticClass:"language-text extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("|----- dist/                            正式环境产出\n|----- conf/                            配置文件\n        |----- alias.js                 公共路径配置文件\n        |----- development.js           开发环境配置文件\n        |----- production.js            正式环境配置文件\n        |----- oss.js                   build之后将文件上传到oss\n|----- src/                             开发目录\n        |----- \bcomponents/              公共业务组件\n        |----- pages/                   页面\n        |----- hoc/                     HOC\n        |----- serverice/ \b              中间层\n        |----- utils/ \b                  通用方法\n        |----- index.css                主css\n        |----- index.js                 主入口文件\n        |----- router.js                路由装载配置\n|----- .editorconfig                    统一开发格式配置文件\n|----- .eslintrc                        开发格式配置文件\n|----- .webpackrc.js \b                   webpack\b配置文件\n|----- .gitignore                       git提交屏蔽文件\n|----- package.json                     npm配置文件\n|----- index.ejs                        index.html模版文件\n\n-------------分割线----------------\n\nscr/pages\npages\n|----- index.js                                 出口文件\n|----- [name]Page                       \b\b        集成业务代码\n        |----- index.js                         集成页面view，model，router\n        |----- components                       当前业务专属组件\n                |----- index.js                 view层\n        |----- [name]                           业务文件夹\n                |----- model.js                 model层\n                |----- [name]Component.js       当前page专属组件\n")])])]),a("p",[t._v("可能用到的插件包，可自行删减")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"axios"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^0.18.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"prop-types"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^15.6.1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"qs"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^6.7.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ali-oss"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^6.0.1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"underscore"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^1.9.1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"husky"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.1.2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"@xxx/xxx"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^x.x.x"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 私有包")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("制作完成，push到git中，如果需要新开管理台，只要pull，"),a("code",[t._v("npm i")]),t._v("，改改nginx即可。nginx我已经脚本化了，很简单就能部署。")]),t._v(" "),a("p",[t._v("注意")]),t._v(" "),a("p",[t._v("登陆、退出、鉴权，预留空间出来，因为每个项目都会有细微差别，让开发人员自行修改即可。")]),t._v(" "),a("p",[t._v("总结：这种项目模版形式，快速开发新业务线，例如运营管理台、财务管理台、等等内部管理台使用，或者作为spa骨架，小程序骨架，pc骨架，为啥要开这么多管理台？少年，你，财务系统、erp系统、cms系统、售后系统，真的不要切分开来么？有精力做权限切分，搞的一个项目臃肿不堪，不如独立。每个平台有自己的账户登陆权限。简单省事，反正都是一套架子，也不存在什么跨项目。升级的话，基础目录即结构不变，升级npm包、升级私有npm包即可。请记住，看上去合并很容易，但复杂度高。分开会加速开发，同时降低复杂度。")]),t._v(" "),a("h2",{attrs:{id:"服务器初始化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务器初始化","aria-hidden":"true"}},[t._v("#")]),t._v(" 服务器初始化")]),t._v(" "),a("p",[t._v("快速在服务器上安装git、nrm、nvm，当然这个是一次性的，后续我做镜像即可。当然有些特殊情况，我也会用到，例如我要制作新的镜像。直接贴代码把不解释了。")]),t._v(" "),a("p",[t._v("安装git")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装最新git")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 需要exit之后再次进入机器，git命令才会生效")]),t._v("\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" curl-devel expat-devel gettext-devel openssl-devel zlib-devel asciidoc "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v("\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" gcc perl-ExtUtils-MakeMaker\nyum remove "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /usr/local/src/\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v(" https://www.kernel.org/pub/software/scm/git/git-2.15.1.tar.xz\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tar")]),t._v(" -vxf git-2.15.1.tar.xz\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" git-2.15.1\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("prefix")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/local/git all\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("prefix")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/local/git "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"export PATH='),a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$PATH")]),t._v(':/usr/local/git/bin"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),t._v(" /etc/profile\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" /etc/profile\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" --version\n")])])]),a("p",[t._v("安装nvm")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装nvm作为node版本控制")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 需要exit之后再次进入机器，nvm命令才会生效")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v(" -qO- https://raw.githubusercontent.com/creationix/nvm/v0.34.0/install.sh "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("bash")]),t._v("\n")])])]),a("p",[t._v("安装nrm")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装nrm作为npm线路控制")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -g nrm\nnrm "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v("\n")])])]),a("p",[t._v("注意：先安装git、nvm，再安装nrm")]),t._v(" "),a("p",[t._v("总结：拒绝重复劳动，我只需要touch git.sh && vim git.sh，拷贝代码，执行即可。当然你可以说制作docker镜像，目前我还没研究透彻。公司专业的运维同学也怪忙的，我只能稍微请教一番，还是我自己先动手把。")]),t._v(" "),a("h2",{attrs:{id:"非代码层面的测试交付"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#非代码层面的测试交付","aria-hidden":"true"}},[t._v("#")]),t._v(" 非代码层面的测试交付")]),t._v(" "),a("p",[t._v("代码层面，通过mock、eslint、code review、单元测试等手段测试可以良好把控。前端程序员很多问题都是跨端，不同app版本测试所带来的。这里我会要求开发人员空出一天或者半天时间，整理业务点，梳理测试的表格。当然也会有，没有测试到的点，这可以通过补充慢慢完善。这东西一般会在大促使用、或者是重要功能，重要项目使用。梳理完成之后，我都会要求开发人员以邮件形式抄送给我，我会二次检查，在项目上线半天前，我会再次要求开发人员以邮件形式抄送给我查看情况，预留给绩效考核，以及我再次检查确认是否有遗漏。")]),t._v(" "),a("p",[t._v("例如：")]),t._v(" "),a("p",[t._v("移动端")]),t._v(" "),a("ul",[a("li",[t._v("UI兼容测试\n"),a("ul",[a("li",[t._v("[ ] iphoneX\n"),a("ul",[a("li",[t._v("[ ] xxx页面")]),t._v(" "),a("li",[t._v("[ ] xxx页面")]),t._v(" "),a("li",[t._v("[ ] xxx页面")])])]),t._v(" "),a("li",[t._v("[ ] iPhone XS\n"),a("ul",[a("li",[t._v("[ ] xxx页面")]),t._v(" "),a("li",[t._v("[ ] xxx页面")]),t._v(" "),a("li",[t._v("[ ] xxx页面")])])]),t._v(" "),a("li",[t._v("[ ] iphone8\n"),a("ul",[a("li",[t._v("[ ] xxx页面")]),t._v(" "),a("li",[t._v("[ ] xxx页面")]),t._v(" "),a("li",[t._v("[ ] xxx页面")])])]),t._v(" "),a("li",[t._v("[ ] 小米8\n"),a("ul",[a("li",[t._v("[ ] xxx页面")]),t._v(" "),a("li",[t._v("[ ] xxx页面")]),t._v(" "),a("li",[t._v("[ ] xxx页面")])])]),t._v(" "),a("li",[t._v("[ ] 小米7\n"),a("ul",[a("li",[t._v("[ ] xxx页面")]),t._v(" "),a("li",[t._v("[ ] xxx页面")]),t._v(" "),a("li",[t._v("[ ] xxx页面")])])]),t._v(" "),a("li",[t._v("[ ] 红米\n"),a("ul",[a("li",[t._v("[ ] xxx页面")]),t._v(" "),a("li",[t._v("[ ] xxx页面")]),t._v(" "),a("li",[t._v("[ ] xxx页面")])])])])])]),t._v(" "),a("p",[t._v("andorid版本测试")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("x.x.x")]),t._v(" "),a("ul",[a("li",[t._v("[ ] 页面功能点")]),t._v(" "),a("li",[t._v("[ ] 页面功能点")]),t._v(" "),a("li",[t._v("[ ] 页面功能点")]),t._v(" "),a("li",[t._v("[ ] 页面功能点")])])]),t._v(" "),a("li",[a("p",[t._v("x.x.x")]),t._v(" "),a("ul",[a("li",[t._v("[ ] 页面功能点")]),t._v(" "),a("li",[t._v("[ ] 页面功能点")]),t._v(" "),a("li",[t._v("[ ] 页面功能点")]),t._v(" "),a("li",[t._v("[ ] 页面功能点")])])])]),t._v(" "),a("p",[t._v("ios版本测试")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("x.x.x")]),t._v(" "),a("ul",[a("li",[t._v("[ ] 页面功能点")]),t._v(" "),a("li",[t._v("[ ] 页面功能点")]),t._v(" "),a("li",[t._v("[ ] 页面功能点")]),t._v(" "),a("li",[t._v("[ ] 页面功能点")])])]),t._v(" "),a("li",[a("p",[t._v("x.x.x")]),t._v(" "),a("ul",[a("li",[t._v("[ ] 页面功能点")]),t._v(" "),a("li",[t._v("[ ] 页面功能点")]),t._v(" "),a("li",[t._v("[ ] 页面功能点")]),t._v(" "),a("li",[t._v("[ ] 页面功能点")])])])]),t._v(" "),a("p",[t._v("微信端测试")]),t._v(" "),a("ul",[a("li",[t._v("x.x.x\n"),a("ul",[a("li",[t._v("[ ] 页面功能点")]),t._v(" "),a("li",[t._v("[ ] 页面功能点")]),t._v(" "),a("li",[t._v("[ ] 页面功能点")]),t._v(" "),a("li",[t._v("[ ] 页面功能点")])])])]),t._v(" "),a("p",[t._v("pc端")]),t._v(" "),a("p",[t._v("UI兼容测试")]),t._v(" "),a("ul",[a("li",[t._v("[ ] xx浏览器 x.x.x版本\n"),a("ul",[a("li",[t._v("[ ] xxx页面")]),t._v(" "),a("li",[t._v("[ ] xxx页面")]),t._v(" "),a("li",[t._v("[ ] xxx页面")])])]),t._v(" "),a("li",[t._v("[ ] xx浏览器 x.x.x版本\n"),a("ul",[a("li",[t._v("[ ] xxx页面")]),t._v(" "),a("li",[t._v("[ ] xxx页面")]),t._v(" "),a("li",[t._v("[ ] xxx页面")])])])]),t._v(" "),a("p",[t._v("xx浏览器 x.x.x版本功能测试")]),t._v(" "),a("ul",[a("li",[t._v("[ ] 页面功能点")]),t._v(" "),a("li",[t._v("[ ] 页面功能点")]),t._v(" "),a("li",[t._v("[ ] 页面功能点")]),t._v(" "),a("li",[t._v("[ ] 页面功能点")])]),t._v(" "),a("p",[t._v("xx浏览器 x.x.x版本功能测试")]),t._v(" "),a("ul",[a("li",[t._v("[ ] 页面功能点")]),t._v(" "),a("li",[t._v("[ ] 页面功能点")]),t._v(" "),a("li",[t._v("[ ] 页面功能点")]),t._v(" "),a("li",[t._v("[ ] 页面功能点")])]),t._v(" "),a("p",[t._v("总结：不是有专业的测试人员么？不好意思，作为程序员自测都不能通过，还写啥代码，还写啥好代码。bug是跟绩效挂钩的，就问你要钱吗？绩效漂亮了，每个季度发钱，大大的给，不爽么？你出去找工作底气足吗？大声喊出，我有完备的测试流程，我写的代码基本0bug，不骄傲么？")]),t._v(" "),a("h2",{attrs:{id:"错误监控"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#错误监控","aria-hidden":"true"}},[t._v("#")]),t._v(" 错误监控")]),t._v(" "),a("p",[t._v("抓取页面js异常，上报UA/错误提示信息、分析日志/5xx/4xx、CDN异常监控、设置n min之内5xx，4xx阈值，这些都是基础运维服务的东西不深入。关注小程序的开发 > 错误查询/性能监控/告警设置。这一块我尚未特别深入，其实都是阿里云的服务设置一下，或者每天检查微信公众平台，或者使用第三方监控平台。有机会详谈。")]),t._v(" "),a("p",[t._v("总结：错误监控，大部分都是基于日志系统的，前端唯一特殊的点就是会有js报错的情况，称之为崩溃率。反正基于日志就对了。pv、uv的？？？？喵喵喵")]),t._v(" "),a("h2",{attrs:{id:"获取最新信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取最新信息","aria-hidden":"true"}},[t._v("#")]),t._v(" 获取最新信息")]),t._v(" "),a("p",[t._v("请用rss订阅的方式，订阅你所使用的开源项目，第一时间获取，version信息、commit信息、fixbug信息，作为leader你要时刻掌握最新咨询，而不是被人告知。")]),t._v(" "),a("h2",{attrs:{id:"结语"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#结语","aria-hidden":"true"}},[t._v("#")]),t._v(" 结语")]),t._v(" "),a("p",[t._v("不好意思，洋洋洒洒写了这么多，能看到这里的，也不容易，牛逼了老弟/老哥/老妹/老姐。说老实话，还有很多地方没说，例如：脚本化小程序发布、脚本化发布多个端的小程序、eslint的使用细节、webhook的使用如何禁止merge、githook细节、commit log 规范、打tag包、钉钉的推送、cdn部署、code review的标准、npm包的标准、单元测试的普及、性能监控、api切分、用中间页鉴权、设备指纹、支付安全、将bs构架快读切换cs构架、如何保证多个项目同时在测试环境同时交付测试、灰度发布等等还有很多东西把，这些就等我慢慢体验了，慢慢整理了。")]),t._v(" "),a("p",[t._v("这些东西为就不能称之为架构，只是我个人的一些逗比操作而已，这套东西3～10人小团队，20条业务线，给我的感觉是可以撑住的。前提是在业务量在高速增长的情况下使用。我曾经问过我师傅，为啥，他在的时候不做，明明他都懂。他回答的是：“公司在什么阶段做什么事情，当公司在寻找主营业务，不停试错时，你固化的构架，就不适合这家公司，当公司寻找到这个点之后，你用构架就能快速辅助开发，业务其实没啥写的，就看怎么写的快，跟上市场，让公司能快速响应市场，或者引领市场”。好吧，我服气")])])},[],!1,null,null,null);s.default=e.exports}}]);